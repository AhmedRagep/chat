
{% extends 'base.html' %}
{% load static %}
{% block content %}
  <div class="flex justify-center items-center">
    <div id="alert" class="text-center bg-green-200 w-[70vh] h-[50px] rounded-xl shadow-xl hidden justify-center items-center">
      <p id="message">Message</p>
    </div>
  </div>
  <!-- section -->
  <p class="m-3 text-center text-sky-700 text-4xl font-bold">Messages</p>
  <div class="flex justify-center">
    <div class="w-[80vh] h-[90vh] py-4 mb-7 bg-blue-400 mt-15 rounded-xl shadow-xl shadow-sky-400 hover:shadow-blue-700">
      {% for frind in all_frinds reversed %}
        <!-- here -->
        <div id="cart-{{frind.id}}" class="w-[77vh] h-[100px] flex justify-between items-center m-2 p-2 bg-white rounded-xl">
          <img src="{{frind.img.url}}" class="w-20 h-20 rounded-full" alt="">
          <div>
            <h3 class="text-center text-3xl font-bold">{{frind.name|title}}</h3>
            <!-- <p class="text-center text-lg">this is body</p> -->
          </div>
          <div class="w-14 h-14 rounded-full bg-sky-300 flex justify-center items-center shadow-md">
            <a onclick="addFriend({{ frind.id }})" class="relative" onmouseover="showTooltip(this)" onmouseleave="handleMouseLeave(event)">
              <div id="tooltip" class="absolute transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-md opacity-0 tooltip" style="top: -50px;left: 15px;">
                <p>Add</p>
              </div>
              <p id="num_msg" class="text-center text-3xl font-bold num_msg"><i id="iconChange-{{frind.id}}" class="fas fa-plus text-4xl"></i></p>
            </a>
            
          </div>
        </div>
        <!-- end here -->
        <script>
          function addFriend(frindId) {
            // alert(frindId)
            let url = "{% url 'add_frinds' 1 %}".replace('1',frindId)
            let iconChange = document.getElementById(`iconChange-${frindId}`);
            let alerts = document.getElementById('alert');
            let msg = document.getElementById('message');
            let cart = document.getElementById(`cart-${frindId}`);

            fetch(url)
              .then(response => response.json())
              .then(data => {
                // إذا تم إضافة الصديق بنجاح، قم بتغيير شكل الأيقونة
                // alert(iconChange)
                iconChange.classList.remove('fa-plus');
                iconChange.classList.add('fa-check', 'text-green-500');
                alerts.classList.remove('hidden');
                alerts.classList.add('flex');
                msg.innerText="Add Frind Successfully.."
                $(alerts).fadeOut(3000)
                $(cart).fadeOut(2000)

              })
              .catch(error => console.error('Error:', error));   
          }
        </script>
      {% endfor %}
    </div>
  </div>
  <!--  /section -->
  

  <script>
    
    function showTooltip(elem) {
        var tooltip = elem.querySelector("#tooltip");
        if (tooltip) {
            tooltip.classList.remove("opacity-0");
            tooltip.classList.add("opacity-100");
        }
    }

    function handleMouseLeave(event) {
        var tooltip = event.target.querySelector("#tooltip");
        var toElement = event.toElement || event.relatedTarget;
        if (tooltip && !tooltip.contains(toElement)) {
            tooltip.classList.remove("opacity-100");
            tooltip.classList.add("opacity-0");
        }
    }
    
    
</script>

{% endblock content %}